<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Similitud y vecinos cercanos | Métodos analíticos, ITAM 2022</title>
  <meta name="description" content="Notas para métodos analíticos 2022" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Similitud y vecinos cercanos | Métodos analíticos, ITAM 2022" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Notas para métodos analíticos 2022" />
  <meta name="github-repo" content="felipexgonzalez/metodos-analiticos-mcd-2022" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Similitud y vecinos cercanos | Métodos analíticos, ITAM 2022" />
  
  <meta name="twitter:description" content="Notas para métodos analíticos 2022" />
  

<meta name="author" content="Felipe González" />


<meta name="date" content="2022-02-02" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="frecuentes.html"/>
<link rel="next" href="referencias.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.20/datatables.js"></script>
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="libs/plotly-binding-4.10.0/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-2.5.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-2.5.1/plotly-latest.min.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Métodos Analíticos</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Temario</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#evaluación"><i class="fa fa-check"></i>Evaluación</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introducción</a>
<ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#simlitud-en-dimensión-alta"><i class="fa fa-check"></i>Simlitud en dimensión alta</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#medidas-de-distancia-o-similitud"><i class="fa fa-check"></i>Medidas de distancia o similitud</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#tipos-de-soluciones"><i class="fa fa-check"></i>Tipos de soluciones</a>
<ul>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#proyección-y-búsqueda-de-marginales-interesantes"><i class="fa fa-check"></i>Proyección y búsqueda de marginales interesantes</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#proyecciones-globales"><i class="fa fa-check"></i>Proyecciones globales</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#descripción-de-estructura-local"><i class="fa fa-check"></i>Descripción de estructura local</a></li>
<li class="chapter" data-level="" data-path="intro.html"><a href="intro.html#inmersiones-embeddings"><i class="fa fa-check"></i>Inmersiones (embeddings)</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="frecuentes.html"><a href="frecuentes.html"><i class="fa fa-check"></i><b>2</b> Análisis de conjuntos frecuentes</a>
<ul>
<li class="chapter" data-level="2.1" data-path="frecuentes.html"><a href="frecuentes.html#datos-de-canastas"><i class="fa fa-check"></i><b>2.1</b> Datos de canastas</a></li>
<li class="chapter" data-level="2.2" data-path="frecuentes.html"><a href="frecuentes.html#conjuntos-frecuentes"><i class="fa fa-check"></i><b>2.2</b> Conjuntos frecuentes</a></li>
<li class="chapter" data-level="2.3" data-path="frecuentes.html"><a href="frecuentes.html#monotonicidad-de-conjuntos-frecuentes"><i class="fa fa-check"></i><b>2.3</b> Monotonicidad de conjuntos frecuentes</a></li>
<li class="chapter" data-level="2.4" data-path="frecuentes.html"><a href="frecuentes.html#algoritmo-a-priori"><i class="fa fa-check"></i><b>2.4</b> Algoritmo a-priori</a></li>
<li class="chapter" data-level="2.5" data-path="frecuentes.html"><a href="frecuentes.html#modelos-simples-para-análisis-de-canastas"><i class="fa fa-check"></i><b>2.5</b> Modelos simples para análisis de canastas</a>
<ul>
<li class="chapter" data-level="" data-path="frecuentes.html"><a href="frecuentes.html#ejemplo-3"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="frecuentes.html"><a href="frecuentes.html#modelo-de-artículos-independientes"><i class="fa fa-check"></i>Modelo de artículos independientes</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="frecuentes.html"><a href="frecuentes.html#soporte-teórico-y-conjuntos-frecuentes"><i class="fa fa-check"></i><b>2.6</b> Soporte teórico y conjuntos frecuentes</a>
<ul>
<li class="chapter" data-level="" data-path="frecuentes.html"><a href="frecuentes.html#ejemplo-4"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="frecuentes.html"><a href="frecuentes.html#reglas-de-asociación"><i class="fa fa-check"></i><b>2.7</b> Reglas de asociación</a>
<ul>
<li class="chapter" data-level="" data-path="frecuentes.html"><a href="frecuentes.html#ejemplo-5"><i class="fa fa-check"></i>Ejemplo</a></li>
<li class="chapter" data-level="" data-path="frecuentes.html"><a href="frecuentes.html#ejemplo-6"><i class="fa fa-check"></i>Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="frecuentes.html"><a href="frecuentes.html#dificultades-en-el-análisis-de-canastas"><i class="fa fa-check"></i><b>2.8</b> Dificultades en el análisis de canastas</a></li>
<li class="chapter" data-level="2.9" data-path="frecuentes.html"><a href="frecuentes.html#otras-medidas-de-calidad-de-reglas"><i class="fa fa-check"></i><b>2.9</b> Otras medidas de calidad de reglas</a>
<ul>
<li class="chapter" data-level="" data-path="frecuentes.html"><a href="frecuentes.html#hyper-lift-bajo-hipótesis-de-independencia"><i class="fa fa-check"></i>Hyper-lift bajo hipótesis de independencia</a></li>
<li class="chapter" data-level="" data-path="frecuentes.html"><a href="frecuentes.html#hyper-lift-para-datos-de-canastas"><i class="fa fa-check"></i>Hyper-lift para datos de canastas</a></li>
</ul></li>
<li class="chapter" data-level="2.10" data-path="frecuentes.html"><a href="frecuentes.html#selección-de-reglas"><i class="fa fa-check"></i><b>2.10</b> Selección de reglas</a>
<ul>
<li class="chapter" data-level="" data-path="frecuentes.html"><a href="frecuentes.html#ejemplo-canastas-grandes"><i class="fa fa-check"></i>Ejemplo: canastas grandes</a></li>
</ul></li>
<li class="chapter" data-level="2.11" data-path="frecuentes.html"><a href="frecuentes.html#búsqueda-de-reglas-especializadas"><i class="fa fa-check"></i><b>2.11</b> Búsqueda de reglas especializadas</a></li>
<li class="chapter" data-level="2.12" data-path="frecuentes.html"><a href="frecuentes.html#visualización-de-asociaciones"><i class="fa fa-check"></i><b>2.12</b> Visualización de asociaciones</a>
<ul>
<li class="chapter" data-level="2.12.1" data-path="frecuentes.html"><a href="frecuentes.html#ejemplo-canastas"><i class="fa fa-check"></i><b>2.12.1</b> Ejemplo</a></li>
</ul></li>
<li class="chapter" data-level="2.13" data-path="frecuentes.html"><a href="frecuentes.html#otras-aplicaciones"><i class="fa fa-check"></i><b>2.13</b> Otras aplicaciones</a></li>
<li class="chapter" data-level="2.14" data-path="frecuentes.html"><a href="frecuentes.html#ejercicios"><i class="fa fa-check"></i><b>2.14</b> Ejercicios</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="similitud.html"><a href="similitud.html"><i class="fa fa-check"></i><b>3</b> Similitud y vecinos cercanos</a>
<ul>
<li class="chapter" data-level="3.1" data-path="similitud.html"><a href="similitud.html#similitud-de-conjuntos"><i class="fa fa-check"></i><b>3.1</b> Similitud de conjuntos</a></li>
<li class="chapter" data-level="3.2" data-path="similitud.html"><a href="similitud.html#representación-de-documentos-como-conjuntos"><i class="fa fa-check"></i><b>3.2</b> Representación de documentos como conjuntos</a></li>
<li class="chapter" data-level="3.3" data-path="similitud.html"><a href="similitud.html#representación-matricial"><i class="fa fa-check"></i><b>3.3</b> Representación matricial</a></li>
<li class="chapter" data-level="3.4" data-path="similitud.html"><a href="similitud.html#minhash-y-reducción-probabilística-de-dimensionalidad"><i class="fa fa-check"></i><b>3.4</b> Minhash y reducción probabilística de dimensionalidad</a></li>
<li class="chapter" data-level="3.5" data-path="similitud.html"><a href="similitud.html#agrupando-textos-de-similitud-alta"><i class="fa fa-check"></i><b>3.5</b> Agrupando textos de similitud alta</a></li>
<li class="chapter" data-level="3.6" data-path="similitud.html"><a href="similitud.html#ejemplo-tweets"><i class="fa fa-check"></i><b>3.6</b> Ejemplo: tweets</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="referencias.html"><a href="referencias.html"><i class="fa fa-check"></i>Referencias</a></li>
<li class="divider"></li>
<li><a href="https://github.com/felipegonzalez/metodos-analiticos-mcd-2022" target="blank">Repositorio de Github</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Métodos analíticos, ITAM 2022</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="similitud" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Similitud y vecinos cercanos</h1>
<p>En esta parte consideraremos la tarea de agrupar eficientemente elementos muy similares
en conjuntos datos masivos.</p>
<p>Algunos ejemplos de esta tarea son:</p>
<ul>
<li>Encontrar documentos similares en una colección de documentos. Esto puede
servir para detectar
plagio, deduplicar noticias o páginas web, hacer <em>matching</em> de datos
de dos fuentes (por ejemplo, nombres completos de personas),
etc. Ver por ejemplo <a href="(https://dl.acm.org/citation.cfm?id=1242610)">Google News</a>.</li>
<li>Encontrar usuarios similares (Netflix), en el sentido de que tienen gustos similares, o películas similares, en el sentido de qe le gustan a las mismas personas.</li>
<li>Encontrar imágenes similares en una colección grande, ver por ejemplo <a href="https://medium.com/@Pinterest_Engineering/detecting-image-similarity-using-spark-lsh-and-tensorflow-618636afc939">Pinterest</a>.</li>
<li>Uber: rutas similares que indican (fraude o abusos)[<a href="https://eng.uber.com/lsh/" class="uri">https://eng.uber.com/lsh/</a>].</li>
<li>Deduplicar registros de usuarios de algún servicio (por ejemplo, beneficiarios
de programas sociales).</li>
</ul>
<p>Estos problemas no son triviales por dos razones:</p>
<ul>
<li>Los elementos que queremos comparar muchas veces están naturalmente representados en espacios de dimensión alta, y es relativamente costoso comparar un par (documentos, imágenes, usuarios, rutas). Muchas veces es preferible construir una representación más compacta y hacer comparaciones con las versiones comprimidas.</li>
<li>Si la colección de elementos es grande (<span class="math inline">\(N\)</span>), entonces el número de pares
posibles es del orden de <span class="math inline">\(N^2\)</span>, y es muy costoso hacer todas las posibles comparaciones para encontrar los elementos similares (por ejemplo, comparar
<span class="math inline">\(100\)</span> mil documentos, con unas <span class="math inline">\(10\)</span> mil comparaciones por segundo, tardaría alrededor de <span class="math inline">\(5\)</span> días).</li>
</ul>
<p>Si tenemos que calcular <em>todas</em> las similitudes, no hay mucho qué hacer. Pero
muchas veces nos interesa encontrar pares de similitud alta, o completar tareas
más específicas como contar duplicados, etc. En estos casos, veremos que es
posible construir soluciones probabilísticas aproximadas para resolver estos
problemas de forma escalable.</p>
<p>Aunque veremos más adelante métricas de similitud comunes como
la dada por la distancia euclideana o distancia coseno, por ejemplo, en
esta primera parte nos concentramos en discutir similitud entre
pares de textos. Los textos los podemos ver como colecciones de palabras, o
de manera más general, como colecciones de cadenas.</p>
<div id="similitud-de-conjuntos" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Similitud de conjuntos</h2>
<p>Muchos de estos problemas de similitud se pueden pensar como
problemas de similitud entre conjuntos. Por ejemplo, los documentos son conjuntos de palabras, conjuntos
de pares de palabras, sucesiones de caracteres,
una película se puede ver como el conjunto de personas a las que les gustó, o una ruta
como un conjunto de tramos, etc.</p>
<p>Hay muchas medidas que son útiles para cuantificar la similitud entre conjuntos. Una que es popular, y que explotaremos por sus propiedades, es la similitud de Jaccard:</p>

<div class="resumen">
La <strong>similitud de Jaccard</strong> de los conjuntos <span class="math inline">\(A\)</span> y <span class="math inline">\(B\)</span> está dada por
<span class="math display">\[sim(A,B) = \frac{|A\cap B|}{|A\cup B|}\]</span>
</div>
<p>Esta medida cuantifica qué tan cerca está la unión de <span class="math inline">\(A\)</span> y <span class="math inline">\(B\)</span> de su intersección. Cuanto más parecidos sean <span class="math inline">\(A\cup B\)</span> y <span class="math inline">\(A\cap B\)</span>, más similares son los conjuntos. En términos geométricos, es el área de la intersección entre el área de la unión.</p>
<div id="ejercicio-3" class="section level4 unnumbered">
<h4>Ejercicio</h4>
<p>Calcula la similitud de Jaccard entre los conjuntos <span class="math inline">\(A=\{5,2,34,1,20,3,4\}\)</span>
y <span class="math inline">\(B=\{19,1,2,5\}\)</span></p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="similitud.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb106-2"><a href="similitud.html#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb106-3"><a href="similitud.html#cb106-3" aria-hidden="true" tabindex="-1"></a>sim_jaccard <span class="ot">&lt;-</span> \(a, b)  <span class="fu">length</span>(<span class="fu">intersect</span>(a, b)) <span class="sc">/</span> <span class="fu">length</span>(<span class="fu">union</span>(a, b))</span>
<span id="cb106-4"><a href="similitud.html#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_jaccard</span>(<span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>), <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">9</span>))</span>
<span id="cb106-5"><a href="similitud.html#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.667</span></span>
<span id="cb106-6"><a href="similitud.html#cb106-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_jaccard</span>(<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">10</span>), <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>))</span>
<span id="cb106-7"><a href="similitud.html#cb106-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.286</span></span>
<span id="cb106-8"><a href="similitud.html#cb106-8" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_jaccard</span>(<span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">1</span>,<span class="dv">10</span>))</span>
<span id="cb106-9"><a href="similitud.html#cb106-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0</span></span></code></pre></div>
</div>
</div>
<div id="representación-de-documentos-como-conjuntos" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Representación de documentos como conjuntos</h2>
<p>Hay varias maneras de representar documentos como conjuntos. Las más simples son:</p>
<ol style="list-style-type: decimal">
<li>Los documentos son colecciones de palabras, o conjuntos de sucesiones de palabras de tamaño <span class="math inline">\(n\)</span>.</li>
<li>Los documentos son colecciones de caracteres, o conjuntos de sucesiones de caracteres (cadenas) de tamaño <span class="math inline">\(k\)</span>.</li>
</ol>
<p>La primera representación se llama <em>representación de n-gramas</em>, y la segunda <em>representación de k-tejas</em>,
o <span class="math inline">\(k\)</span>-<em>shingles</em>. Nótese que en ambos casos, representaciones de dos documentos con secciones parecidas acomodadas en distintos lugares tienden a ser similares.</p>
<p>Consideremos una colección de textos cortos:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="similitud.html#cb107-1" aria-hidden="true" tabindex="-1"></a>textos <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;el perro persigue al gato pero no lo alcanza&quot;</span>, </span>
<span id="cb107-2"><a href="similitud.html#cb107-2" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;el gato persigue al perro, pero no lo alcanza&quot;</span>, </span>
<span id="cb107-3"><a href="similitud.html#cb107-3" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;este es el documento de ejemplo&quot;</span>, </span>
<span id="cb107-4"><a href="similitud.html#cb107-4" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;este no es el documento de los ejemplos&quot;</span>,</span>
<span id="cb107-5"><a href="similitud.html#cb107-5" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;documento más corto&quot;</span>,</span>
<span id="cb107-6"><a href="similitud.html#cb107-6" aria-hidden="true" tabindex="-1"></a>            <span class="st">&quot;otros animales pueden ser mascotas&quot;</span>)</span></code></pre></div>
<p>Abajo mostramos la representacion en bolsa de palabras (1-gramas) y la representación en bigramas (2-gramas) de los primeros dos documentos:</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="similitud.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Bolsa de palabras (1-gramas)</span></span>
<span id="cb108-2"><a href="similitud.html#cb108-2" aria-hidden="true" tabindex="-1"></a>tokenizers<span class="sc">::</span><span class="fu">tokenize_ngrams</span>(textos[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">n =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">map</span>(unique)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;el&quot;       &quot;perro&quot;    &quot;persigue&quot; &quot;al&quot;       &quot;gato&quot;     &quot;pero&quot;     &quot;no&quot;      
## [8] &quot;lo&quot;       &quot;alcanza&quot; 
## 
## [[2]]
## [1] &quot;el&quot;       &quot;gato&quot;     &quot;persigue&quot; &quot;al&quot;       &quot;perro&quot;    &quot;pero&quot;     &quot;no&quot;      
## [8] &quot;lo&quot;       &quot;alcanza&quot;</code></pre>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="similitud.html#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># bigramas</span></span>
<span id="cb110-2"><a href="similitud.html#cb110-2" aria-hidden="true" tabindex="-1"></a>tokenizers<span class="sc">::</span><span class="fu">tokenize_ngrams</span>(textos[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">n =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">map</span>(unique)</span></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;el perro&quot;       &quot;perro persigue&quot; &quot;persigue al&quot;    &quot;al gato&quot;       
## [5] &quot;gato pero&quot;      &quot;pero no&quot;        &quot;no lo&quot;          &quot;lo alcanza&quot;    
## 
## [[2]]
## [1] &quot;el gato&quot;       &quot;gato persigue&quot; &quot;persigue al&quot;   &quot;al perro&quot;     
## [5] &quot;perro pero&quot;    &quot;pero no&quot;       &quot;no lo&quot;         &quot;lo alcanza&quot;</code></pre>
<p>La representación en <em>k-tejas</em> es otra posibilidad:</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="similitud.html#cb112-1" aria-hidden="true" tabindex="-1"></a>calcular_tejas <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">k =</span> <span class="dv">2</span>){</span>
<span id="cb112-2"><a href="similitud.html#cb112-2" aria-hidden="true" tabindex="-1"></a>  tokenizers<span class="sc">::</span><span class="fu">tokenize_character_shingles</span>(x, <span class="at">n =</span> k, <span class="at">lowercase =</span> <span class="cn">FALSE</span>,</span>
<span id="cb112-3"><a href="similitud.html#cb112-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">simplify =</span> <span class="cn">TRUE</span>, <span class="at">strip_non_alpha =</span> <span class="cn">FALSE</span>)</span>
<span id="cb112-4"><a href="similitud.html#cb112-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb112-5"><a href="similitud.html#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 2-tejas</span></span>
<span id="cb112-6"><a href="similitud.html#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="fu">calcular_tejas</span>(textos[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">k =</span> <span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">map</span>(unique)</span></code></pre></div>
<pre><code>## [[1]]
##  [1] &quot;el&quot; &quot;l &quot; &quot; p&quot; &quot;pe&quot; &quot;er&quot; &quot;rr&quot; &quot;ro&quot; &quot;o &quot; &quot;rs&quot; &quot;si&quot; &quot;ig&quot; &quot;gu&quot; &quot;ue&quot; &quot;e &quot; &quot; a&quot;
## [16] &quot;al&quot; &quot; g&quot; &quot;ga&quot; &quot;at&quot; &quot;to&quot; &quot; n&quot; &quot;no&quot; &quot; l&quot; &quot;lo&quot; &quot;lc&quot; &quot;ca&quot; &quot;an&quot; &quot;nz&quot; &quot;za&quot;
## 
## [[2]]
##  [1] &quot;el&quot; &quot;l &quot; &quot; g&quot; &quot;ga&quot; &quot;at&quot; &quot;to&quot; &quot;o &quot; &quot; p&quot; &quot;pe&quot; &quot;er&quot; &quot;rs&quot; &quot;si&quot; &quot;ig&quot; &quot;gu&quot; &quot;ue&quot;
## [16] &quot;e &quot; &quot; a&quot; &quot;al&quot; &quot;rr&quot; &quot;ro&quot; &quot;o,&quot; &quot;, &quot; &quot; n&quot; &quot;no&quot; &quot; l&quot; &quot;lo&quot; &quot;lc&quot; &quot;ca&quot; &quot;an&quot; &quot;nz&quot;
## [31] &quot;za&quot;</code></pre>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="similitud.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 4-tejas:&quot;</span></span>
<span id="cb114-2"><a href="similitud.html#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">calcular_tejas</span>(textos[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>], <span class="at">k =</span> <span class="dv">4</span>) <span class="sc">|&gt;</span> <span class="fu">map</span>(unique)</span></code></pre></div>
<pre><code>## [[1]]
##  [1] &quot;el p&quot; &quot;l pe&quot; &quot; per&quot; &quot;perr&quot; &quot;erro&quot; &quot;rro &quot; &quot;ro p&quot; &quot;o pe&quot; &quot;pers&quot; &quot;ersi&quot;
## [11] &quot;rsig&quot; &quot;sigu&quot; &quot;igue&quot; &quot;gue &quot; &quot;ue a&quot; &quot;e al&quot; &quot; al &quot; &quot;al g&quot; &quot;l ga&quot; &quot; gat&quot;
## [21] &quot;gato&quot; &quot;ato &quot; &quot;to p&quot; &quot;pero&quot; &quot;ero &quot; &quot;ro n&quot; &quot;o no&quot; &quot; no &quot; &quot;no l&quot; &quot;o lo&quot;
## [31] &quot; lo &quot; &quot;lo a&quot; &quot;o al&quot; &quot; alc&quot; &quot;alca&quot; &quot;lcan&quot; &quot;canz&quot; &quot;anza&quot;
## 
## [[2]]
##  [1] &quot;el g&quot; &quot;l ga&quot; &quot; gat&quot; &quot;gato&quot; &quot;ato &quot; &quot;to p&quot; &quot;o pe&quot; &quot; per&quot; &quot;pers&quot; &quot;ersi&quot;
## [11] &quot;rsig&quot; &quot;sigu&quot; &quot;igue&quot; &quot;gue &quot; &quot;ue a&quot; &quot;e al&quot; &quot; al &quot; &quot;al p&quot; &quot;l pe&quot; &quot;perr&quot;
## [21] &quot;erro&quot; &quot;rro,&quot; &quot;ro, &quot; &quot;o, p&quot; &quot;, pe&quot; &quot;pero&quot; &quot;ero &quot; &quot;ro n&quot; &quot;o no&quot; &quot; no &quot;
## [31] &quot;no l&quot; &quot;o lo&quot; &quot; lo &quot; &quot;lo a&quot; &quot;o al&quot; &quot; alc&quot; &quot;alca&quot; &quot;lcan&quot; &quot;canz&quot; &quot;anza&quot;</code></pre>
<p><strong>Observaciones</strong>:</p>
<ol style="list-style-type: decimal">
<li>Los <em>tokens</em> son las unidades básicas de análisis. Los <em>tokens</em> son palabras para los n-gramas (cuya definición no es del todo simple) y caracteres para las k-tejas. Podrían ser también oraciones, por ejemplo.</li>
<li>Nótese que en ambos casos es posible hacer algo de preprocesamiento para
obtener la representación. Transformaciones usuales son:</li>
</ol>
<ul>
<li>Eliminar puntuación y/o espacios.</li>
<li>Convertir los textos a minúsculas.</li>
<li>Esto incluye decisiones acerca de qué hacer con palabras compuestas (por ejemplo, con un guión), palabras que denotan un concepto (Reino Unido, por ejemplo) y otros detalles.</li>
</ul>
<ol start="3" style="list-style-type: decimal">
<li>Si lo que nos interesa principalmente
similitud textual (no significado, o polaridad, etc.) entre documentos, entonces podemos usar <span class="math inline">\(k\)</span>-tejas, con un mínimo de preprocesamiento. Esta
representación es <strong>simple y flexible</strong> en el sentido de que se puede adaptar para documentos muy cortos (mensajes o tweets, por ejemplo), pero también para documentos más grandes.</li>
</ol>
<p>Por estas razones, no concentramos por el momento en <span class="math inline">\(k\)</span>-tejas</p>

<div class="resumen">
<p><strong>Tejas (shingles)</strong></p>
Sea <span class="math inline">\(k&gt;0\)</span> un entero. Las <span class="math inline">\(k\)</span>-tejas (<span class="math inline">\(k\)</span>-shingles) de un documento d
es el conjunto de todas las corridas (distintas) de <span class="math inline">\(k\)</span>
caracteres sucesivos.
Escogemos <span class="math inline">\(k\)</span> suficientemente grande, de forma que la probabilidad de que
una teja particular ocurra en un texto dado sea relativamente baja.
</div>
<div id="ejemplo-8" class="section level4 unnumbered">
<h4>Ejemplo</h4>
<p>Documentos textualmente similares tienen tejas similares:</p>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="similitud.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calcular tejas</span></span>
<span id="cb116-2"><a href="similitud.html#cb116-2" aria-hidden="true" tabindex="-1"></a>textos</span>
<span id="cb116-3"><a href="similitud.html#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] &quot;el perro persigue al gato pero no lo alcanza&quot; </span></span>
<span id="cb116-4"><a href="similitud.html#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [2] &quot;el gato persigue al perro, pero no lo alcanza&quot;</span></span>
<span id="cb116-5"><a href="similitud.html#cb116-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [3] &quot;este es el documento de ejemplo&quot;              </span></span>
<span id="cb116-6"><a href="similitud.html#cb116-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [4] &quot;este no es el documento de los ejemplos&quot;      </span></span>
<span id="cb116-7"><a href="similitud.html#cb116-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [5] &quot;documento más corto&quot;                          </span></span>
<span id="cb116-8"><a href="similitud.html#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [6] &quot;otros animales pueden ser mascotas&quot;</span></span>
<span id="cb116-9"><a href="similitud.html#cb116-9" aria-hidden="true" tabindex="-1"></a>tejas_doc <span class="ot">&lt;-</span> <span class="fu">calcular_tejas</span>(textos, <span class="at">k =</span> <span class="dv">4</span>)</span>
<span id="cb116-10"><a href="similitud.html#cb116-10" aria-hidden="true" tabindex="-1"></a><span class="co"># calcular similitud de jaccard entre algunos pares</span></span>
<span id="cb116-11"><a href="similitud.html#cb116-11" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_jaccard</span>(tejas_doc[[<span class="dv">1</span>]], tejas_doc[[<span class="dv">2</span>]])</span>
<span id="cb116-12"><a href="similitud.html#cb116-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.773</span></span>
<span id="cb116-13"><a href="similitud.html#cb116-13" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_jaccard</span>(tejas_doc[[<span class="dv">1</span>]], tejas_doc[[<span class="dv">3</span>]])</span>
<span id="cb116-14"><a href="similitud.html#cb116-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0</span></span>
<span id="cb116-15"><a href="similitud.html#cb116-15" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_jaccard</span>(tejas_doc[[<span class="dv">4</span>]], tejas_doc[[<span class="dv">5</span>]])</span>
<span id="cb116-16"><a href="similitud.html#cb116-16" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.156</span></span></code></pre></div>
<p>Podemos calcular todas las similitudes:</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="similitud.html#cb117-1" aria-hidden="true" tabindex="-1"></a>tejas_tbl <span class="ot">&lt;-</span> <span class="fu">crossing</span>(<span class="at">id_1 =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(textos), <span class="at">id_2 =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(textos)) <span class="sc">|&gt;</span></span>
<span id="cb117-2"><a href="similitud.html#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(id_1 <span class="sc">&lt;</span> id_2) <span class="sc">|&gt;</span> </span>
<span id="cb117-3"><a href="similitud.html#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tejas_1 =</span> tejas_doc[id_1], <span class="at">tejas_2 =</span> tejas_doc[id_2]) <span class="sc">|&gt;</span>   </span>
<span id="cb117-4"><a href="similitud.html#cb117-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sim =</span> <span class="fu">map2_dbl</span>(tejas_1, tejas_2, <span class="sc">~</span><span class="fu">sim_jaccard</span>(.x, .y))) <span class="sc">|&gt;</span> </span>
<span id="cb117-5"><a href="similitud.html#cb117-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(id_1, id_2, sim)</span>
<span id="cb117-6"><a href="similitud.html#cb117-6" aria-hidden="true" tabindex="-1"></a>tejas_tbl</span></code></pre></div>
<pre><code>## # A tibble: 15 × 3
##     id_1  id_2    sim
##    &lt;int&gt; &lt;int&gt;  &lt;dbl&gt;
##  1     1     2 0.773 
##  2     1     3 0     
##  3     1     4 0.0137
##  4     1     5 0     
##  5     1     6 0     
##  6     2     3 0     
##  7     2     4 0.0133
##  8     2     5 0     
##  9     2     6 0     
## 10     3     4 0.6   
## 11     3     5 0.189 
## 12     3     6 0     
## 13     4     5 0.156 
## 14     4     6 0     
## 15     5     6 0</code></pre>
<p>pero nótese que, como señalamos arriba, esta operación será muy
costosa incluso si la colección de textos es de tamaño moderado.</p>
<ul>
<li><p>Si los textos
son cortos, entonces basta tomar valores como <span class="math inline">\(k=4,5\)</span>, pues hay un total de <span class="math inline">\(27^4\)</span> tejas
de tamaño <span class="math inline">\(4\)</span>, y el número de tejas de un documento corto (mensajes, tweets) es mucho más bajo que
<span class="math inline">\(27^4\)</span> (nota: ¿puedes explicar por qué este argumento no es exactamente correcto?)</p></li>
<li><p>Para documentos grandes, como noticias o artículos, es mejor escoger un tamaño más grande,
como <span class="math inline">\(k=9,10\)</span>, pues en documentos largos puede haber cientos de miles
de caracteres. Si <span class="math inline">\(k\)</span> fuera más chica entonces una gran parte de las tejas aparecerá en muchos de los documentos, y todos los documentos tendrían similitud alta.</p></li>
<li><p>Evitamos escoger <span class="math inline">\(k\)</span> demasiado grande, pues entonces los únicos documentos similares tendrían
que tener subcadenas largas exactamente iguales. Por ejemplo: “Batman y Robin” y “Robin y Batman” son algo
similares si usamos tejas de tamaño 3, pero son muy distintas si usamos tejas de tamaño 8:</p></li>
</ul>
</div>
<div id="ejemplo-9" class="section level4 unnumbered">
<h4>Ejemplo</h4>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="similitud.html#cb119-1" aria-hidden="true" tabindex="-1"></a>tejas_1 <span class="ot">&lt;-</span> <span class="fu">calcular_tejas</span>(<span class="st">&quot;Batman y Robin&quot;</span>, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb119-2"><a href="similitud.html#cb119-2" aria-hidden="true" tabindex="-1"></a>tejas_2 <span class="ot">&lt;-</span> <span class="fu">calcular_tejas</span>(<span class="st">&quot;Robin y Batman&quot;</span>, <span class="at">k =</span> <span class="dv">3</span>)</span>
<span id="cb119-3"><a href="similitud.html#cb119-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_jaccard</span>(tejas_1, tejas_2)</span></code></pre></div>
<pre><code>## [1] 0.6</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="similitud.html#cb121-1" aria-hidden="true" tabindex="-1"></a>tejas_1 <span class="ot">&lt;-</span> <span class="fu">calcular_tejas</span>(<span class="st">&quot;Batman y Robin&quot;</span>, <span class="at">k =</span> <span class="dv">8</span>)</span>
<span id="cb121-2"><a href="similitud.html#cb121-2" aria-hidden="true" tabindex="-1"></a>tejas_2 <span class="ot">&lt;-</span> <span class="fu">calcular_tejas</span>(<span class="st">&quot;Robin y Batman&quot;</span>, <span class="at">k =</span> <span class="dv">8</span>)</span>
<span id="cb121-3"><a href="similitud.html#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sim_jaccard</span>(tejas_1, tejas_2)</span></code></pre></div>
<pre><code>## [1] 0</code></pre>
</div>
</div>
<div id="representación-matricial" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Representación matricial</h2>
<p>Podemos usar una matriz binaria para guardar todas las
representaciones en k-tejas de nuestra colección de documentos. Puede usarse
una representación rala (<em>sparse</em>) si es necesario:</p>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="similitud.html#cb123-1" aria-hidden="true" tabindex="-1"></a>dtejas_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">id =</span> <span class="fu">paste0</span>(<span class="st">&quot;doc_&quot;</span>, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(textos)), </span>
<span id="cb123-2"><a href="similitud.html#cb123-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">tejas =</span> tejas_doc) <span class="sc">|&gt;</span> </span>
<span id="cb123-3"><a href="similitud.html#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="at">cols =</span> tejas) <span class="sc">|&gt;</span> </span>
<span id="cb123-4"><a href="similitud.html#cb123-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>() <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">val =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb123-5"><a href="similitud.html#cb123-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_wider</span>(<span class="at">names_from =</span> id, <span class="at">values_from =</span> val, <span class="at">values_fill =</span> <span class="fu">list</span>(<span class="at">val =</span> <span class="dv">0</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb123-6"><a href="similitud.html#cb123-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(tejas) <span class="co"># opcionalmente ordenamos tejas</span></span>
<span id="cb123-7"><a href="similitud.html#cb123-7" aria-hidden="true" tabindex="-1"></a>dtejas_tbl</span></code></pre></div>
<pre><code>## # A tibble: 123 × 7
##    tejas  doc_1 doc_2 doc_3 doc_4 doc_5 doc_6
##    &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 &quot; al &quot;     1     1     0     0     0     0
##  2 &quot; alc&quot;     1     1     0     0     0     0
##  3 &quot; ani&quot;     0     0     0     0     0     1
##  4 &quot; cor&quot;     0     0     0     0     1     0
##  5 &quot; de &quot;     0     0     1     1     0     0
##  6 &quot; doc&quot;     0     0     1     1     0     0
##  7 &quot; eje&quot;     0     0     1     1     0     0
##  8 &quot; el &quot;     0     0     1     1     0     0
##  9 &quot; es &quot;     0     0     1     1     0     0
## 10 &quot; gat&quot;     1     1     0     0     0     0
## # … with 113 more rows</code></pre>
<p>¿Cómo calculamos la similitud de Jaccard usando estos datos?</p>
<p>Calcular la unión e intersección se puede hacer haciendo OR y AND de las columnas, y
entonces podemos calcular la similitud</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="similitud.html#cb125-1" aria-hidden="true" tabindex="-1"></a>inter_12 <span class="ot">&lt;-</span> <span class="fu">sum</span>(dtejas_tbl<span class="sc">$</span>doc_1 <span class="sc">&amp;</span> dtejas_tbl<span class="sc">$</span>doc_2)</span>
<span id="cb125-2"><a href="similitud.html#cb125-2" aria-hidden="true" tabindex="-1"></a>union_12 <span class="ot">&lt;-</span> <span class="fu">sum</span>(dtejas_tbl<span class="sc">$</span>doc_1 <span class="sc">|</span> dtejas_tbl<span class="sc">$</span>doc_2)</span>
<span id="cb125-3"><a href="similitud.html#cb125-3" aria-hidden="true" tabindex="-1"></a>similitud <span class="ot">&lt;-</span> inter_12<span class="sc">/</span>union_12</span>
<span id="cb125-4"><a href="similitud.html#cb125-4" aria-hidden="true" tabindex="-1"></a>similitud <span class="co"># comparar con el número que obtuvimos arriba.</span></span></code></pre></div>
<pre><code>## [1] 0.773</code></pre>
<p>El cálculo para todos los documentos podríamos hacerlo (aunque veremos que normalmente
no haremos esto si no necesitamos calcular todas las similitudes) con:</p>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="similitud.html#cb127-1" aria-hidden="true" tabindex="-1"></a>mat_td <span class="ot">&lt;-</span> dtejas_tbl <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>tejas) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb127-2"><a href="similitud.html#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> <span class="fu">dist</span>(mat_td, <span class="at">method =</span> <span class="st">&quot;binary&quot;</span>)</span></code></pre></div>
<pre><code>##        doc_1  doc_2  doc_3  doc_4  doc_5
## doc_2 0.7727                            
## doc_3 0.0000 0.0000                     
## doc_4 0.0137 0.0133 0.6000              
## doc_5 0.0000 0.0000 0.1892 0.1556       
## doc_6 0.0000 0.0000 0.0000 0.0000 0.0000</code></pre>
</div>
<div id="minhash-y-reducción-probabilística-de-dimensionalidad" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Minhash y reducción probabilística de dimensionalidad</h2>
<p>Para una colección grande de documentos
la representación binaria de la colección de documentos
puede tener un número muy grande de renglones. Puede ser posible
crear un número más chico de nuevos <em>features</em> (ojo: aquí los renglones
son las “variables,” y los casos son las columnas) con los que
sea posible obtener una buena aproximación de la similitud.</p>
<p>La idea básica es la siguiente:</p>
<ul>
<li>Escogemos una función al azar (una función <em>hash</em>) que mapea cadenas cortas a un número grande de enteros, de manera existe muy baja probabilidad de colisiones, y no hay correlación entre las cadenas y el valor al que son mapeados.</li>
<li>Si un documento tiene tejas <span class="math inline">\(T\)</span>, aplicamos la función hash a cada teja de <span class="math inline">\(T\)</span>, y calculamos el mínimo de estos valores hash.</li>
<li>Repetimos este proceso para varias funciones hash fijas, por ejemplo <span class="math inline">\(k= 5\)</span></li>
<li>Los valores mínimos obtenidos nos dan una representación en dimensión baja de cada
documento.</li>
</ul>
<div id="ejemplo-10" class="section level4 unnumbered">
<h4>Ejemplo</h4>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="similitud.html#cb129-1" aria-hidden="true" tabindex="-1"></a>textos_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">doc_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(textos), <span class="at">texto =</span> textos)</span>
<span id="cb129-2"><a href="similitud.html#cb129-2" aria-hidden="true" tabindex="-1"></a>tejas_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">doc_id =</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(textos), <span class="at">tejas =</span> tejas_doc)</span>
<span id="cb129-3"><a href="similitud.html#cb129-3" aria-hidden="true" tabindex="-1"></a>tejas_tbl</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   doc_id tejas     
##    &lt;int&gt; &lt;list&gt;    
## 1      1 &lt;chr [41]&gt;
## 2      2 &lt;chr [42]&gt;
## 3      3 &lt;chr [28]&gt;
## 4      4 &lt;chr [36]&gt;
## 5      5 &lt;chr [16]&gt;
## 6      6 &lt;chr [31]&gt;</code></pre>
<p>Creamos una función hash:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="similitud.html#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">813</span>)</span>
<span id="cb131-2"><a href="similitud.html#cb131-2" aria-hidden="true" tabindex="-1"></a>generar_hash <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb131-3"><a href="similitud.html#cb131-3" aria-hidden="true" tabindex="-1"></a>  r <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(stats<span class="sc">::</span><span class="fu">runif</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2147483647</span>))</span>
<span id="cb131-4"><a href="similitud.html#cb131-4" aria-hidden="true" tabindex="-1"></a>  funcion_hash <span class="ot">&lt;-</span> <span class="cf">function</span>(tejas){</span>
<span id="cb131-5"><a href="similitud.html#cb131-5" aria-hidden="true" tabindex="-1"></a>        digest<span class="sc">::</span><span class="fu">digest2int</span>(tejas, <span class="at">seed =</span> r) </span>
<span id="cb131-6"><a href="similitud.html#cb131-6" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb131-7"><a href="similitud.html#cb131-7" aria-hidden="true" tabindex="-1"></a>  funcion_hash</span>
<span id="cb131-8"><a href="similitud.html#cb131-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb131-9"><a href="similitud.html#cb131-9" aria-hidden="true" tabindex="-1"></a>h_1 <span class="ot">&lt;-</span> <span class="fu">generar_hash</span>()</span></code></pre></div>
<p>Y aplicamos la función a cada teja del documento 1, y tomamos el mínimo:</p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="similitud.html#cb132-1" aria-hidden="true" tabindex="-1"></a>hashes_1 <span class="ot">&lt;-</span> <span class="fu">h_1</span>(tejas_tbl<span class="sc">$</span>tejas[[<span class="dv">1</span>]])</span>
<span id="cb132-2"><a href="similitud.html#cb132-2" aria-hidden="true" tabindex="-1"></a>hashes_1</span></code></pre></div>
<pre><code>##  [1] -1318809190 -1534091290 -1401861150 -1601894665   781339434  -519860631
##  [7]  2116727945 -1824301917 -1401861150 -1371561364 -1385084918  -821046029
## [13]  1766711521  1952075680   569109680 -1412107908  1059544482 -1866546594
## [19]  2090868926  -455965089   784118133  1421354549 -1397404756  -481987742
## [25] -1824301917 -1401861150  1157451749   698137483  -623448608   544014704
## [31]  -587926856  1455454405   950121497  -165719415  2119479774  2115904977
## [37]  1519310299  1652203243  -667865842  1219377605 -1500087628</code></pre>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="similitud.html#cb134-1" aria-hidden="true" tabindex="-1"></a>minhash_1 <span class="ot">&lt;-</span> <span class="fu">min</span>(hashes_1)</span>
<span id="cb134-2"><a href="similitud.html#cb134-2" aria-hidden="true" tabindex="-1"></a>minhash_1</span></code></pre></div>
<pre><code>## [1] -1866546594</code></pre>
<p>Consideramos este <em>minhash</em> como un descriptor del documento. Generalmente
usamos más de un descriptor. En el siguiente ejemplo usamos 4 funciones
hash creadas de manera independiente:</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="similitud.html#cb136-1" aria-hidden="true" tabindex="-1"></a>hashes <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>, <span class="sc">~</span> <span class="fu">generar_hash</span>())</span>
<span id="cb136-2"><a href="similitud.html#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="similitud.html#cb136-3" aria-hidden="true" tabindex="-1"></a>docs_firmas <span class="ot">&lt;-</span> tejas_tbl <span class="sc">|&gt;</span> </span>
<span id="cb136-4"><a href="similitud.html#cb136-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">firma =</span> <span class="fu">map</span>(tejas, \(lista) <span class="fu">map_int</span>(hashes, \(h) <span class="fu">min</span>(<span class="fu">h</span>(lista))))) <span class="sc">|&gt;</span> </span>
<span id="cb136-5"><a href="similitud.html#cb136-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(doc_id, firma) <span class="sc">|&gt;</span> </span>
<span id="cb136-6"><a href="similitud.html#cb136-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_wider</span>(firma, <span class="at">names_sep =</span> <span class="st">&quot;_&quot;</span>)</span>
<span id="cb136-7"><a href="similitud.html#cb136-7" aria-hidden="true" tabindex="-1"></a>docs_firmas</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##   doc_id     firma_1     firma_2     firma_3     firma_4
##    &lt;int&gt;       &lt;int&gt;       &lt;int&gt;       &lt;int&gt;       &lt;int&gt;
## 1      1 -2129712961 -2124594172 -2073157333 -1982715048
## 2      2 -2129712961 -2124594172 -2073157333 -1982715048
## 3      3 -2139075502 -2093452194 -1959662839 -2048484934
## 4      4 -2139075502 -2093452194 -1959662839 -2048484934
## 5      5 -2106131386 -2093452194 -2127642881 -1984764210
## 6      6 -2115397946 -2087727654 -2074217109 -1986993146</code></pre>
<p>Nótese ahora que en documentos muy similares, varios de los minhashes coinciden. Esto
es porque la teja donde ocurrió el mínimo está en los dos documentos. Entonces
cuando los las tejas de dos documentos son muy similares, es muy probable que sus
minhashes coincidan.</p>
<p>¿Cuál es la probabilidad de que la firma coincida para un documento?</p>

<div class="resumen">
Sea <span class="math inline">\(h\)</span> una función <em>hash</em> escogida escogida al azar, y <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> dos documentos dados
dadas. Denotamos como <span class="math inline">\(f_h\)</span> la función minhash asociada a <span class="math inline">\(h\)</span>. Entonces
<span class="math display">\[P(f_h(a) = f_h(b)) = sim(a, b)\]</span>
donde <span class="math inline">\(sim\)</span> es la similitud de Jaccard basada en las tejas usadas.
Sean <span class="math inline">\(h_1, h_2, \ldots h_n\)</span> funciones <em>hash</em> escogidas al azar de
manera independiente. Si <span class="math inline">\(n\)</span> es grande, entonces por la ley de los grandes números
<span class="math display">\[sim(a,b) \approx \frac{|h_j : f_{h_j}{\pi_j}(a) = f_{h_j}(b)|}{n},\]</span>
es decir, la similitud de Jaccard es aproximadamente la proporción
de elementos de las firmas que coinciden.
</div>
<p>Ahora damos un argumento para demostrar este resultado:</p>
<p>Supongamos que el total de tejas de los dos documentos es <span class="math inline">\(|A\cup B|\)</span>, y el
número de tejas que tienen en común es <span class="math inline">\(|A\cap B|\)</span>. Sea <span class="math inline">\(h\)</span> la función <em>hash</em>
que escogimos al azar.</p>
<p>Para fijar ideas, puedes suponer que las tejas están numeradas <span class="math inline">\(1,\ldots, M\)</span>, y
la función <em>hash</em> es una permutación aleatoria de estos números.</p>
<p>Entonces:</p>
<ol style="list-style-type: decimal">
<li>El mínimo de <span class="math inline">\(h\)</span> puede ocurrir en cualquier elemento de <span class="math inline">\(|A\cup B|\)</span> con
la misma probabilidad.</li>
<li>Los minhashes de <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> coinciden si y sólo si el mínimo de <span class="math inline">\(h\)</span> ocurre en un elemento
de <span class="math inline">\(|A\cap B|\)</span></li>
<li>Por 1 y 2, la probabilidad de que esto ocurra es
<span class="math display">\[\frac{|A\cap B|}{|A\cup B|},\]</span>
que es la similitud de Jaccard.</li>
</ol>
<p>Nótese que esto requiere que la familia de donde escogemos nuestra función
<em>hash</em> cumple, al menos aproximadamente, las propiedades 1 y 2. Para que 1 ocurra,
la familia debe ser suficientemente grande y variada: por ejemplo, esto fallaría si
todas las cadenas que comienzan con “a” se mapean a números chicos. Para que
ocurra 2, no debe haber colisiones (cadenas distintas que se mapean al mismo valor).</p>
<p><strong>Observaciónes</strong>:</p>
<ul>
<li><p>Una familia que cumple de manera exacta estas dos propiedades
es la familia de permutaciones que mencionamos arriba: numeramos las tejas, construimos
una permutación al azar, y luego aplicamos esta función de permutaciones a los índices
de las tejas. La razón por la que esta familia no es utiliza típicamente es porque
es costosa si el número de tejas es grande: primero hay que escoger un ordenamiento al azar, y luego es necesario almacenarlo.</p></li>
<li><p>Muchas veces, se utiliza una función hash con aritmética
modular como sigue: sea <span class="math inline">\(M\)</span> el número total
de tejas, y sea <span class="math inline">\(p\)</span> un número primo fijo grande (al menos <span class="math inline">\(p &gt; M\)</span>).
Numeramos las tejas. Ahora escogemos dos enteros <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span> al azar, y hacemos
<span class="math display">\[h(x) = (ax + b\mod p) \mod M\]</span>
Estas funciones se pueden seleccionar y aplicar rápidamente, y sólo tenemos que almacenar los coeficientes <span class="math inline">\(a\)</span> y <span class="math inline">\(b\)</span>.</p></li>
<li><p>En el enfoque que vimos arriba, utilizamos directamente una función <em>hash</em> de cadenas
que está diseñada para cumplir 1 y 2 de manera aproximada.</p></li>
</ul>

<div class="resumen">
<strong>Resumen</strong>. Con el método de minhash, representamos a los documentos con un
número relativamente chico de atributos numéricos (reducción de dimensionalidad). Esta
respresentación tiene la propiedad de que textos muy similares con probabilidad
alta coinciden en uno o más de los descriptores.
</div>
</div>
</div>
<div id="agrupando-textos-de-similitud-alta" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Agrupando textos de similitud alta</h2>
<p>Nuestro siguiente paso es evitar hacer la comparación de todos los pares de descriptores.
Para esto hacemos un clustering no exhaustivo basado en los descriptores que
acabamos de construir.</p>
<p>Recordemos que tenemos</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="similitud.html#cb138-1" aria-hidden="true" tabindex="-1"></a>docs_firmas</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##   doc_id     firma_1     firma_2     firma_3     firma_4
##    &lt;int&gt;       &lt;int&gt;       &lt;int&gt;       &lt;int&gt;       &lt;int&gt;
## 1      1 -2129712961 -2124594172 -2073157333 -1982715048
## 2      2 -2129712961 -2124594172 -2073157333 -1982715048
## 3      3 -2139075502 -2093452194 -1959662839 -2048484934
## 4      4 -2139075502 -2093452194 -1959662839 -2048484934
## 5      5 -2106131386 -2093452194 -2127642881 -1984764210
## 6      6 -2115397946 -2087727654 -2074217109 -1986993146</code></pre>
<p>Ahora agrupamos documentos que comparten alguna firma. A los grupos
que coinciden en cada firma les llamamos <em>cubetas</em>:</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="similitud.html#cb140-1" aria-hidden="true" tabindex="-1"></a>cubetas_tbl <span class="ot">&lt;-</span> docs_firmas <span class="sc">|&gt;</span> <span class="fu">pivot_longer</span>(<span class="fu">contains</span>(<span class="st">&quot;firma_&quot;</span>), <span class="st">&quot;n_firma&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb140-2"><a href="similitud.html#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cubeta =</span> <span class="fu">paste</span>(n_firma, value)) <span class="sc">|&gt;</span> </span>
<span id="cb140-3"><a href="similitud.html#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cubeta) <span class="sc">|&gt;</span> </span>
<span id="cb140-4"><a href="similitud.html#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">documentos =</span> <span class="fu">list</span>(doc_id)) <span class="sc">|&gt;</span> </span>
<span id="cb140-5"><a href="similitud.html#cb140-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">num_docs =</span> <span class="fu">map_int</span>(documentos, length))</span>
<span id="cb140-6"><a href="similitud.html#cb140-6" aria-hidden="true" tabindex="-1"></a>cubetas_tbl</span></code></pre></div>
<pre><code>## # A tibble: 15 × 3
##    cubeta              documentos num_docs
##    &lt;chr&gt;               &lt;list&gt;        &lt;int&gt;
##  1 firma_1 -2106131386 &lt;int [1]&gt;         1
##  2 firma_1 -2115397946 &lt;int [1]&gt;         1
##  3 firma_1 -2129712961 &lt;int [2]&gt;         2
##  4 firma_1 -2139075502 &lt;int [2]&gt;         2
##  5 firma_2 -2087727654 &lt;int [1]&gt;         1
##  6 firma_2 -2093452194 &lt;int [3]&gt;         3
##  7 firma_2 -2124594172 &lt;int [2]&gt;         2
##  8 firma_3 -1959662839 &lt;int [2]&gt;         2
##  9 firma_3 -2073157333 &lt;int [2]&gt;         2
## 10 firma_3 -2074217109 &lt;int [1]&gt;         1
## 11 firma_3 -2127642881 &lt;int [1]&gt;         1
## 12 firma_4 -1982715048 &lt;int [2]&gt;         2
## 13 firma_4 -1984764210 &lt;int [1]&gt;         1
## 14 firma_4 -1986993146 &lt;int [1]&gt;         1
## 15 firma_4 -2048484934 &lt;int [2]&gt;         2</code></pre>
<p>Ahora filtramos las cubetas que tienen más de un elemento:</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="similitud.html#cb142-1" aria-hidden="true" tabindex="-1"></a>cubetas_tbl <span class="ot">&lt;-</span> cubetas_tbl <span class="sc">|&gt;</span> </span>
<span id="cb142-2"><a href="similitud.html#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_docs <span class="sc">&gt;</span> <span class="dv">1</span>)</span>
<span id="cb142-3"><a href="similitud.html#cb142-3" aria-hidden="true" tabindex="-1"></a>cubetas_tbl </span></code></pre></div>
<pre><code>## # A tibble: 8 × 3
##   cubeta              documentos num_docs
##   &lt;chr&gt;               &lt;list&gt;        &lt;int&gt;
## 1 firma_1 -2129712961 &lt;int [2]&gt;         2
## 2 firma_1 -2139075502 &lt;int [2]&gt;         2
## 3 firma_2 -2093452194 &lt;int [3]&gt;         3
## 4 firma_2 -2124594172 &lt;int [2]&gt;         2
## 5 firma_3 -1959662839 &lt;int [2]&gt;         2
## 6 firma_3 -2073157333 &lt;int [2]&gt;         2
## 7 firma_4 -1982715048 &lt;int [2]&gt;         2
## 8 firma_4 -2048484934 &lt;int [2]&gt;         2</code></pre>
<p>Y de aquí extraemos <strong>pares candidatos</strong> que tienen alta probabilidad de
ser muy similares:</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="similitud.html#cb144-1" aria-hidden="true" tabindex="-1"></a>pares_tbl <span class="ot">&lt;-</span> cubetas_tbl <span class="sc">|&gt;</span> </span>
<span id="cb144-2"><a href="similitud.html#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pares_cand =</span> <span class="fu">map</span>(documentos, <span class="sc">~</span> <span class="fu">combn</span>(.x, <span class="dv">2</span>, <span class="at">simplify =</span> <span class="cn">FALSE</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb144-3"><a href="similitud.html#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cubeta, pares_cand) <span class="sc">|&gt;</span> </span>
<span id="cb144-4"><a href="similitud.html#cb144-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(pares_cand) <span class="sc">|&gt;</span> </span>
<span id="cb144-5"><a href="similitud.html#cb144-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_wider</span>(pares_cand, <span class="at">names_sep =</span> <span class="st">&quot;_&quot;</span>) </span>
<span id="cb144-6"><a href="similitud.html#cb144-6" aria-hidden="true" tabindex="-1"></a>pares_tbl</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    cubeta              pares_cand_1 pares_cand_2
##    &lt;chr&gt;                      &lt;int&gt;        &lt;int&gt;
##  1 firma_1 -2129712961            1            2
##  2 firma_1 -2139075502            3            4
##  3 firma_2 -2093452194            3            4
##  4 firma_2 -2093452194            3            5
##  5 firma_2 -2093452194            4            5
##  6 firma_2 -2124594172            1            2
##  7 firma_3 -1959662839            3            4
##  8 firma_3 -2073157333            1            2
##  9 firma_4 -1982715048            1            2
## 10 firma_4 -2048484934            3            4</code></pre>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="similitud.html#cb146-1" aria-hidden="true" tabindex="-1"></a>pares_tbl <span class="ot">&lt;-</span> pares_tbl <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>cubeta) <span class="sc">|&gt;</span> </span>
<span id="cb146-2"><a href="similitud.html#cb146-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unique</span>()</span>
<span id="cb146-3"><a href="similitud.html#cb146-3" aria-hidden="true" tabindex="-1"></a>pares_tbl</span></code></pre></div>
<pre><code>## # A tibble: 4 × 2
##   pares_cand_1 pares_cand_2
##          &lt;int&gt;        &lt;int&gt;
## 1            1            2
## 2            3            4
## 3            3            5
## 4            4            5</code></pre>
<p>Nótese que con este proceso evitamos hacer todas las comparaciones, y el método
tiene complejidad lineal en el tamaño de la colección de documentos. Una vez que tenemos
los pares, podemos calcular la similitud exacta de solamente esos documentos:</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="similitud.html#cb148-1" aria-hidden="true" tabindex="-1"></a>pares_tbl <span class="sc">|&gt;</span> </span>
<span id="cb148-2"><a href="similitud.html#cb148-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tejas_tbl <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">pares_cand_1 =</span> doc_id, <span class="at">texto_1 =</span> tejas)) <span class="sc">|&gt;</span> </span>
<span id="cb148-3"><a href="similitud.html#cb148-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tejas_tbl <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">pares_cand_2 =</span> doc_id, <span class="at">texto_2 =</span> tejas)) <span class="sc">|&gt;</span> </span>
<span id="cb148-4"><a href="similitud.html#cb148-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">score =</span> <span class="fu">map2_dbl</span>(texto_1, texto_2, <span class="sc">~</span> <span class="fu">sim_jaccard</span>(.x, .y))) <span class="sc">|&gt;</span> </span>
<span id="cb148-5"><a href="similitud.html#cb148-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;texto&quot;</span>))</span></code></pre></div>
<pre><code>## Joining, by = &quot;pares_cand_1&quot;</code></pre>
<pre><code>## Joining, by = &quot;pares_cand_2&quot;</code></pre>
<pre><code>## # A tibble: 4 × 3
##   pares_cand_1 pares_cand_2 score
##          &lt;int&gt;        &lt;int&gt; &lt;dbl&gt;
## 1            1            2 0.773
## 2            3            4 0.6  
## 3            3            5 0.189
## 4            4            5 0.156</code></pre>
<p>Si queremos capturar solamente aquellos pares de similitud muy alta,
podemos también combinar firmas para formar cubetas donde las dos firmas coinciden:</p>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="similitud.html#cb152-1" aria-hidden="true" tabindex="-1"></a>cubetas_tbl <span class="ot">&lt;-</span> docs_firmas <span class="sc">|&gt;</span> </span>
<span id="cb152-2"><a href="similitud.html#cb152-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cubeta =</span> <span class="fu">paste</span>(firma_1, firma_2)) <span class="sc">|&gt;</span> </span>
<span id="cb152-3"><a href="similitud.html#cb152-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cubeta) <span class="sc">|&gt;</span> </span>
<span id="cb152-4"><a href="similitud.html#cb152-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">documentos =</span> <span class="fu">list</span>(doc_id)) <span class="sc">|&gt;</span> </span>
<span id="cb152-5"><a href="similitud.html#cb152-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">num_docs =</span> <span class="fu">map_int</span>(documentos, length))</span>
<span id="cb152-6"><a href="similitud.html#cb152-6" aria-hidden="true" tabindex="-1"></a>cubetas_tbl</span></code></pre></div>
<pre><code>## # A tibble: 4 × 3
##   cubeta                  documentos num_docs
##   &lt;chr&gt;                   &lt;list&gt;        &lt;int&gt;
## 1 -2106131386 -2093452194 &lt;int [1]&gt;         1
## 2 -2115397946 -2087727654 &lt;int [1]&gt;         1
## 3 -2129712961 -2124594172 &lt;int [2]&gt;         2
## 4 -2139075502 -2093452194 &lt;int [2]&gt;         2</code></pre>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="similitud.html#cb154-1" aria-hidden="true" tabindex="-1"></a>pares_tbl <span class="ot">&lt;-</span> cubetas_tbl <span class="sc">|&gt;</span> </span>
<span id="cb154-2"><a href="similitud.html#cb154-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_docs <span class="sc">&gt;</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> </span>
<span id="cb154-3"><a href="similitud.html#cb154-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">pares_cand =</span> <span class="fu">map</span>(documentos, <span class="sc">~</span> <span class="fu">combn</span>(.x, <span class="dv">2</span>, <span class="at">simplify =</span> <span class="cn">FALSE</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb154-4"><a href="similitud.html#cb154-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(cubeta, pares_cand) <span class="sc">|&gt;</span> </span>
<span id="cb154-5"><a href="similitud.html#cb154-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(pares_cand) <span class="sc">|&gt;</span> </span>
<span id="cb154-6"><a href="similitud.html#cb154-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_wider</span>(pares_cand, <span class="at">names_sep =</span> <span class="st">&quot;_&quot;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb154-7"><a href="similitud.html#cb154-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tejas_tbl <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">pares_cand_1 =</span> doc_id, <span class="at">texto_1 =</span> tejas)) <span class="sc">|&gt;</span> </span>
<span id="cb154-8"><a href="similitud.html#cb154-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(tejas_tbl <span class="sc">|&gt;</span> <span class="fu">rename</span>(<span class="at">pares_cand_2 =</span> doc_id, <span class="at">texto_2 =</span> tejas)) <span class="sc">|&gt;</span> </span>
<span id="cb154-9"><a href="similitud.html#cb154-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">score =</span> <span class="fu">map2_dbl</span>(texto_1, texto_2, <span class="sc">~</span> <span class="fu">sim_jaccard</span>(.x, .y))) <span class="sc">|&gt;</span> </span>
<span id="cb154-10"><a href="similitud.html#cb154-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span><span class="fu">contains</span>(<span class="st">&quot;texto&quot;</span>))</span></code></pre></div>
<pre><code>## Joining, by = &quot;pares_cand_1&quot;</code></pre>
<pre><code>## Joining, by = &quot;pares_cand_2&quot;</code></pre>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="similitud.html#cb157-1" aria-hidden="true" tabindex="-1"></a>pares_tbl</span></code></pre></div>
<pre><code>## # A tibble: 2 × 4
##   cubeta                  pares_cand_1 pares_cand_2 score
##   &lt;chr&gt;                          &lt;int&gt;        &lt;int&gt; &lt;dbl&gt;
## 1 -2129712961 -2124594172            1            2 0.773
## 2 -2139075502 -2093452194            3            4 0.6</code></pre>
</div>
<div id="ejemplo-tweets" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Ejemplo: tweets</h2>
<p>Ahora buscaremos tweets similares en una colección de un <a href="https://www.kaggle.com/rgupta09/world-cup-2018-tweets/home?utm_medium=email&amp;utm_source=mailchimp&amp;utm_campaign=datanotes-20180823">dataset de
kaggle</a>.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="similitud.html#cb159-1" aria-hidden="true" tabindex="-1"></a>ruta <span class="ot">&lt;-</span> <span class="st">&quot;../datos/FIFA.csv&quot;</span></span>
<span id="cb159-2"><a href="similitud.html#cb159-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">file.exists</span>(ruta)){</span>
<span id="cb159-3"><a href="similitud.html#cb159-3" aria-hidden="true" tabindex="-1"></a>    fifa <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;https://fifatweets.s3.amazonaws.com/FIFA.csv&quot;</span>)</span>
<span id="cb159-4"><a href="similitud.html#cb159-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">write_csv</span>(fifa, <span class="st">&quot;../datos/FIFA.csv&quot;</span>)</span>
<span id="cb159-5"><a href="similitud.html#cb159-5" aria-hidden="true" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb159-6"><a href="similitud.html#cb159-6" aria-hidden="true" tabindex="-1"></a>    fifa <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(ruta)</span>
<span id="cb159-7"><a href="similitud.html#cb159-7" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## Rows: 530000 Columns: 16</code></pre>
<pre><code>## ── Column specification ────────────────────────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr  (9): lang, Source, Orig_Tweet, Tweet, Hashtags, UserMentionNames, UserM...
## dbl  (6): ID, len, Likes, RTs, Followers, Friends
## dttm (1): Date</code></pre>
<pre><code>## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="similitud.html#cb163-1" aria-hidden="true" tabindex="-1"></a>tw <span class="ot">&lt;-</span> fifa<span class="sc">$</span>Tweet</span>
<span id="cb163-2"><a href="similitud.html#cb163-2" aria-hidden="true" tabindex="-1"></a>tw[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>##  [1] &quot;Only two goalkeepers have saved three penalties in penalty shoot out Ricardo vs&quot;                         
##  [2] &quot;scores the winning penalty to send into the quarter finals where they will face Russia&quot;                  
##  [3] &quot;Tonight we have big game&quot;                                                                                
##  [4] &quot;We get stronger Turn the music up now We got that power power&quot;                                           
##  [5] &quot;Only two goalkeepers have saved three penalties in penalty shoot out Ricardo vs&quot;                         
##  [6] &quot;We re looking strong going into the knockout stage We caught up with ahead of&quot;                           
##  [7] &quot;am happy for winning Especially since you know we colluded and all Russia eliminates Spain after penalty&quot;
##  [8] &quot;When you see me When we feel the same feeling Power power&quot;                                               
##  [9] &quot;Kasper Schmeichel takes the final award of the day&quot;                                                      
## [10] &quot;After Years Global Puma Ambassador LG Mobile Ambassador CocaCola WorldCup Kookmin Bank UNICEF&quot;</code></pre>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="similitud.html#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9192</span>)</span>
<span id="cb165-2"><a href="similitud.html#cb165-2" aria-hidden="true" tabindex="-1"></a>num_tweets <span class="ot">&lt;-</span> <span class="dv">100000</span></span>
<span id="cb165-3"><a href="similitud.html#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(tejas_doc <span class="ot">&lt;-</span> <span class="fu">calcular_tejas</span>(tw[<span class="dv">1</span><span class="sc">:</span>num_tweets], <span class="at">k =</span> <span class="dv">5</span>))</span></code></pre></div>
<pre><code>##    user  system elapsed 
##   3.171   0.058   3.230</code></pre>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="similitud.html#cb167-1" aria-hidden="true" tabindex="-1"></a>tejas_tbl <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">doc_id =</span> <span class="dv">1</span><span class="sc">:</span>num_tweets, <span class="at">tejas =</span> tejas_doc)</span>
<span id="cb167-2"><a href="similitud.html#cb167-2" aria-hidden="true" tabindex="-1"></a>hash_f <span class="ot">&lt;-</span> <span class="fu">map</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>, <span class="sc">~</span> <span class="fu">generar_hash</span>())</span>
<span id="cb167-3"><a href="similitud.html#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="fu">system.time</span>(</span>
<span id="cb167-4"><a href="similitud.html#cb167-4" aria-hidden="true" tabindex="-1"></a>  docs_firmas <span class="ot">&lt;-</span> tejas_tbl <span class="sc">|&gt;</span> </span>
<span id="cb167-5"><a href="similitud.html#cb167-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">firma =</span> <span class="fu">map</span>(tejas, \(lista) <span class="fu">map_int</span>(hash_f, \(h) <span class="fu">min</span>(<span class="fu">h</span>(lista))))) <span class="sc">|&gt;</span> </span>
<span id="cb167-6"><a href="similitud.html#cb167-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(doc_id, firma)) </span></code></pre></div>
<pre><code>##    user  system elapsed 
##   27.78    0.02   27.80</code></pre>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="similitud.html#cb169-1" aria-hidden="true" tabindex="-1"></a>docs_firmas</span></code></pre></div>
<pre><code>## # A tibble: 100,000 × 2
##    doc_id firma     
##     &lt;int&gt; &lt;list&gt;    
##  1      1 &lt;int [50]&gt;
##  2      2 &lt;int [50]&gt;
##  3      3 &lt;int [50]&gt;
##  4      4 &lt;int [50]&gt;
##  5      5 &lt;int [50]&gt;
##  6      6 &lt;int [50]&gt;
##  7      7 &lt;int [50]&gt;
##  8      8 &lt;int [50]&gt;
##  9      9 &lt;int [50]&gt;
## 10     10 &lt;int [50]&gt;
## # … with 99,990 more rows</code></pre>
<p>La firma de minhashes del primer documento es por ejemplo:</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="similitud.html#cb171-1" aria-hidden="true" tabindex="-1"></a>docs_firmas<span class="sc">$</span>firma[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>## [[1]]
##  [1] -1953455759 -2112001395 -2031432865 -2108080560 -2095602723 -2118858341
##  [7] -2099337985 -1978298401 -2092751862 -2097330616 -1897306653 -2139645671
## [13] -1981364640 -2081406116 -2127003388 -2138613184 -2146084782 -2082312909
## [19] -2083329993 -2001255852 -2091106849 -2091293600 -2120806067 -2095725804
## [25] -2143199361 -2091159512 -2124095195 -2038461037 -2109684884 -2073791594
## [31] -2129542593 -1904599938 -2118234795 -2056298394 -2105031889 -2113931139
## [37] -2134167293 -2140440957 -1717523835 -2144768923 -2138027225 -2084388635
## [43] -2110278901 -2135431955 -2139423769 -2130397390 -2097742891 -2105787557
## [49] -2101425996 -1941363605</code></pre>
<p>Y probaremos primero hacer cubetas con algunas las firmas:</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="similitud.html#cb173-1" aria-hidden="true" tabindex="-1"></a>docs_firmas <span class="ot">&lt;-</span> docs_firmas <span class="sc">|&gt;</span> </span>
<span id="cb173-2"><a href="similitud.html#cb173-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cubeta_nombre =</span> <span class="fu">map_chr</span>(firma, \(x) <span class="fu">paste</span>(x[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>], <span class="at">collapse =</span> <span class="st">&quot;-&quot;</span>)))</span>
<span id="cb173-3"><a href="similitud.html#cb173-3" aria-hidden="true" tabindex="-1"></a>docs_cubetas_tbl <span class="ot">&lt;-</span> </span>
<span id="cb173-4"><a href="similitud.html#cb173-4" aria-hidden="true" tabindex="-1"></a>  docs_firmas <span class="sc">|&gt;</span> </span>
<span id="cb173-5"><a href="similitud.html#cb173-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(cubeta_nombre) <span class="sc">|&gt;</span> </span>
<span id="cb173-6"><a href="similitud.html#cb173-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">docs =</span> <span class="fu">list</span>(doc_id)) <span class="sc">|&gt;</span> </span>
<span id="cb173-7"><a href="similitud.html#cb173-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">num_docs =</span> <span class="fu">map_int</span>(docs, length)) <span class="sc">|&gt;</span> </span>
<span id="cb173-8"><a href="similitud.html#cb173-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(num_docs <span class="sc">&gt;</span> <span class="dv">1</span>)</span></code></pre></div>
<p>Y examinamos ahora algunas de las cubetas:</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="similitud.html#cb174-1" aria-hidden="true" tabindex="-1"></a>docs_ejemplo <span class="ot">&lt;-</span> docs_cubetas_tbl<span class="sc">$</span>docs[[<span class="dv">125</span>]]</span>
<span id="cb174-2"><a href="similitud.html#cb174-2" aria-hidden="true" tabindex="-1"></a>tw[docs_ejemplo]</span></code></pre></div>
<pre><code>## [1] &quot;We got That power power&quot; &quot;We got That power power&quot;
## [3] &quot;We got That power power&quot;</code></pre>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="similitud.html#cb176-1" aria-hidden="true" tabindex="-1"></a>docs_ejemplo <span class="ot">&lt;-</span> docs_cubetas_tbl<span class="sc">$</span>docs[[<span class="dv">1658</span>]]</span>
<span id="cb176-2"><a href="similitud.html#cb176-2" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(docs_ejemplo)</span></code></pre></div>
<pre><code>## [1] 406</code></pre>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="similitud.html#cb178-1" aria-hidden="true" tabindex="-1"></a>tw[docs_ejemplo][<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div>
<pre><code>##  [1] &quot;short story involving Nigeria Argentina and France&quot;
##  [2] &quot;short story involving Nigeria Argentina and France&quot;
##  [3] &quot;short story involving Nigeria Argentina and France&quot;
##  [4] &quot;short story involving Nigeria Argentina and France&quot;
##  [5] &quot;short story involving Nigeria Argentina and France&quot;
##  [6] &quot;short story involving Nigeria Argentina and France&quot;
##  [7] &quot;short story involving Nigeria Argentina and France&quot;
##  [8] &quot;short story involving Nigeria Argentina and France&quot;
##  [9] &quot;short story involving Nigeria Argentina and France&quot;
## [10] &quot;short story involving Nigeria Argentina and France&quot;</code></pre>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="similitud.html#cb180-1" aria-hidden="true" tabindex="-1"></a>docs_ejemplo <span class="ot">&lt;-</span> docs_cubetas_tbl<span class="sc">$</span>docs[[<span class="dv">4958</span>]]</span>
<span id="cb180-2"><a href="similitud.html#cb180-2" aria-hidden="true" tabindex="-1"></a>tw[docs_ejemplo]</span></code></pre></div>
<pre><code>## [1] &quot;The keeps on serving us more and more drama If you missed any of the great moments from todays fixtures yo&quot;                             
## [2] &quot;The keeps on serving us more and more drama If you missed any of the great moments from todays fixtures yo&quot;                             
## [3] &quot;The keeps on serving us more and more drama If you missed any of the great moments from todays fixtures yo&quot;                             
## [4] &quot;The keeps on serving us more and more drama If you missed any of the great moments from todays fixtures you can watch the highlights on&quot;
## [5] &quot;The keeps on serving us more and more drama If you missed any of the great moments from todays fixtures you can watch the highlights on&quot;</code></pre>
<p>Con este método, podemos extraer pares de muy alta similitud (cercano a duplicados) de forma eficiente en colecciones grandes de texto.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="frecuentes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="referencias.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/felipegonzalez/metodos-analiticos-mcd-2022/edit/master/notas/02-similitud-1.Rmd",
"text": "Editar"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
